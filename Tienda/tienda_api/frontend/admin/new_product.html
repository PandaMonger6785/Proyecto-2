{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Nuevo producto — Panel</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <style>
    .panel-wrap{max-width:960px;margin:24px auto;background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 10px rgba(0,0,0,.08)}
    .panel-wrap h1{margin:0 0 14px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .grid .full{grid-column:1/-1}
    .field label{display:block;font-weight:700;margin:8px 0 6px}
    .field input[type="text"],.field input[type="number"],.field input[type="file"],
    .field input[type="url"],.field input[type="email"],.field input[type="slug"],
    .field textarea,.field input[type="decimal"]{width:100%;padding:10px;border:1px solid #d1d5db;border-radius:8px}
    .actions{display:flex;gap:10px;margin-top:12px}
    .btn{border:0;border-radius:10px;padding:12px 14px;cursor:pointer;font-weight:700}
    .btn-primary{background:#ffa41c;color:#111}
    .note{color:#4b5563;font-size:.9rem}
    .list ul{margin:8px 0 0;padding:0;list-style:none}
    .list li{padding:6px 0;border-bottom:1px solid #eee;display:flex;justify-content:space-between;gap:12px}
    .price{font-weight:700}
    .messages{margin-bottom:10px}
    .messages .error{background:#fee2e2;color:#991b1b;padding:8px;border-radius:8px;margin-bottom:6px}
    .messages .ok{background:#dcfce7;color:#166534;padding:8px;border-radius:8px;margin-bottom:6px}
    @media (max-width:860px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="panel-wrap">
    <h1>Crear nuevo producto</h1>

    <div class="messages">
      {% for m in messages %}
        <div class="{% if m.tags %}{{ m.tags }}{% endif %}">{{ m }}</div>
      {% endfor %}
    </div>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="grid">
        <div class="field">
          <label for="{{ form.name.id_for_label }}">Nombre</label>
          {{ form.name }}
        </div>
        <div class="field">
          <label for="{{ form.slug.id_for_label }}">Slug (opcional)</label>
          {{ form.slug }}
          <div class="note">Si lo dejas vacío se genera a partir del nombre.</div>
        </div>
        <div class="field">
          <label for="{{ form.price.id_for_label }}">Precio (MXN)</label>
          {{ form.price }}
        </div>
        <div class="field">
          <label for="{{ form.category.id_for_label }}">Categoría</label>
          {{ form.category }}
        </div>
        <div class="field">
          <label for="{{ form.stock.id_for_label }}">Stock</label>
          {{ form.stock }}
        </div>
        <div class="field">
          <label for="{{ form.is_active.id_for_label }}">{{ form.is_active }} Activo</label>
        </div>
        <div class="field full">
          <label for="{{ form.description.id_for_label }}">Descripción</label>
          {{ form.description }}
        </div>
        <div class="field full">
          <label for="{{ form.image_file.id_for_label }}">Imagen</label>
          {{ form.image_file }}
          <div class="note">
            Se guardará en <code>frontend/img/</code> y la ruta en BD será <code>img/archivo.ext</code>.<br>
            El front la servirá como <code>/static/img/archivo.ext</code>.
          </div>
        </div>
      </div>

      <div class="actions">
        <button type="submit" class="btn btn-primary">Guardar producto</button>
        <a href="/admin/" class="btn btn-ghost">Ir al admin</a>
        <a href="/" class="btn btn-ghost">Ir a la tienda</a>
      </div>
    </form>

    <hr style="margin:20px 0">

    <div class="list">
      <h2>Últimos productos creados</h2>
      <ul>
        {% for p in last_products %}
          <li>
            <span>{{ p.name }} — <span class="price">${{ p.price }}</span></span>
            <code>{{ p.image }}</code>
          </li>
        {% empty %}
          <li>No hay productos aún.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</body>
</html>
