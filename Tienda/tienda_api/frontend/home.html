{% extends "base.html" %}
{% load static %}

{% block title %}Inicio - Tienda{% endblock %}

{% block content %}
  <section class="hero-simple">
    <div class="hero-inner">
      <h2>Descubre nuestras ofertas</h2>
      <p>Productos con envío rápido y garantía.</p>
    </div>
  </section>

  <div class="tabs" role="tablist" aria-label="categorías">
    <button class="tab" aria-selected="true" role="tab" data-category="">Todos</button>
    <button class="tab" role="tab" data-category="Ofertas">Ofertas</button>
  </div>

  <div id="catChips" style="max-width:1400px;margin:10px auto 0;padding:0 12px;display:flex;gap:8px;flex-wrap:wrap"></div>

  <section class="tab-panel">
    <div id="grid" class="grid-products" aria-live="polite"></div>
  </section>

  <!-- Modal: Detalles -->
  <div id="detailsModal" class="modal hidden" aria-hidden="true">
    <div class="modal-backdrop" data-close="1"></div>
    <article class="modal-card" role="dialog" aria-modal="true" aria-labelledby="detTitle">
      <header style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:10px">
        <h3 id="detTitle" style="margin:0">Detalles del producto</h3>
        <button class="btn btn-ghost" data-close="1">Cerrar</button>
      </header>
      <div style="display:grid;grid-template-columns:minmax(260px,340px) 1fr;gap:16px;align-items:start">
        <img id="detImg" src="{% static 'img/placeholder.png' %}" alt="Imagen"
             style="width:100%;height:280px;object-fit:cover;border-radius:12px;background:#f3f3f3">
        <div>
          <h4 id="detName" style="margin:0 0 4px"></h4>
          <div id="detPrice" class="price"></div>
          <div id="detMeta" style="color:#6b7280;margin:6px 0 12px"></div>
          <p id="detDesc" style="white-space:pre-wrap;margin:0;max-height:48vh;overflow:auto"></p>
        </div>
      </div>
    </article>
  </div>

  <!-- Modal: Cantidad -->
  <div id="qtyModal" class="modal hidden" aria-hidden="true">
    <div class="modal-backdrop" data-close="1"></div>
    <article class="modal-card" role="dialog" aria-modal="true" aria-labelledby="qtyTitle">
      <h3 id="qtyTitle" style="margin:0 0 8px">Agregar al carrito</h3>
      <p class="cm-name" id="cmName"></p>
      <div class="cm-row"><label for="cmQty">Cantidad</label><input id="cmQty" type="number" min="1" value="1"></div>
      <div class="cm-row"><label>Precio unitario</label><strong id="cmUnit">$0.00</strong></div>
      <div class="cm-row total"><label>Total</label><strong id="cmTotal">$0.00</strong></div>
      <div class="cm-actions">
        <button class="btn btn-ghost" data-close="1">Cancelar</button>
        <button class="btn btn-primary" id="cmConfirm">Agregar</button>
      </div>
    </article>
  </div>
{% endblock %}

{% block extra_js %}
  <script>
    window.PRODUCTS_API = window.PRODUCTS_API || "/api/products/?format=json";
  </script>
{% endblock %}

